# MADE_CV_HW2

Общий пайплайн:
1. Сегментация всего изображения UNetом
2. Поиск областей, где вероятно есть номер (эвристика) - получаем набор прямоугольников
3. Повторная сегментация этой области тем же UNetом - для каждого прямоугольника получаем маску
4. В каждом прямоугольнике пытаемся определить угол наклона маски (эвристика)
5. Выравниваем номер, отрезаем лишнее по краям, подгоняем под единый размер.
6. Шаги 1-5 повторям для двух разрешений, и для каждого разрешения берём две версии картинки - на одну накладываем маску, на другую - нет. Т.е. на входе распознавалки у нас как минимум 4 варианта для каждого кропа. Собираем их в группы, по группе на каждый вероятный номер (по IoU прямоугольников).
7. Распознаём. Здесь использовалось 4 варианта модели из бейзлайна, с разными FE (resnet18 и resnet50) и разными размерами картинки (32 и 64 пикселя по высоте). Для каждой модели использовалось по 4 чекпоинта. В результате получилось множество вариантов предикта для каждого кропа (16 моделей на минимум 4х картинках каждая).
8. Отдельную модель для определеия есть номер в кропе или это шум я не делал, вместо этого я сравнивал предикты разных моделей, в предположении, что шум распознаётся по-разному, а номера - более или менее одинаково.
9. Собираем окончательный сабмит, сопоставляя предикты моделей между собой.
